{% extends 'dashboard/dashboard_base.html' %}

{% block content %}




  <div class="dashboard__content_content">

    {% with messages = get_flashed_messages(with_categories=True) %}
      {% if messages %}
        <div id="flash-messages">
          {% for category, message in messages %}
            {% if category == 'success' %}
              <div class="alert alert-success" style="color: #fff;background-color: #05a35c;height:45px;width:80%;border-radius:10px;text-align:center;" role="alert">
                {{message}}
              </div>
            {% elif category == 'error' %}
                <div class="alert alert-danger" style="color: #fff;background-color: #ff1919c9;height:45px;width:80%;border-radius:10px;text-align:center;" role="alert">
                  {{message}}
                </div>
              
            {% endif %}
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}
<div   class="d-flex justify-content-between">
    <h1 class="text-30">Add Tour</h1>
   
   
</div>
    <div class="rounded-12 bg-white shadow-2 px-40 pt-40 pb-30 mt-60">
      <div class="tabs -underline-2 js-tabs">
        <div class="tabs__controls row x-gap-40 y-gap-10 lg:x-gap-20 js-tabs-controls">

          <div class="col-auto">
            <button class="tabs__button text-20 lh-12 fw-500 pb-15 lg:pb-0 js-tabs-button is-tab-el-active" data-tab-target=".-tab-item-1">Create a New Destination</button>
          </div>

        </div>
        <form action='/addtour' method='POST' enctype="multipart/form-data">
          <div class="row pt-40">
            <div class="col-12">
              <div class="tabs__content js-tabs-content">
                <div class="tabs__pane -tab-item-1 is-tab-el-active">
                  <div class="contactForm row y-gap-30">
                    <div class="col-12">

                      <div class="form-input ">
                        <input type="text" name='title' required>
                        <label class="lh-1 text-16 text-light-1">Tour Title</label>
                      </div>

                    </div>
                    <div class="col-12">

                      <div class="form-input ">
                        <label class="lh-1 text-16 ">Category</label>
                      <div class="form-input ">
                        
                        <select name="category" required>
                          <option value='Cruises'>Cruises</option>
                          <option value='Hiking'>Hiking</option>
                          <option value='Airbirds'>Airbirds</option>
                          <option value='Wildlife'>Wildlife</option>
                          <option value='Walking'>Walking</option>
                          <option value='Island'>Island</option>
                        
                        </select>
                        
                      </div>
                      </div>

                    </div>
                    
                    <div class="col-12">
                      <label class="lh-1 text-16 ">Destination Image</label>
                      <div class="form-input ">
                        <input type="file" class='form-control' name='main_image' required >
                        
                      </div>

                    </div>
                    <div class="col-12">

                      <div class="form-input ">
                        <label class="lh-1 text-16 ">Ratings</label>
                      <div class="form-input ">
                        
                        <select name="rating" required>
                          <option value='1'>1</option>
                          <option value='2'>2</option>
                          <option value='3'>3</option>
                          <option value='4'>4</option>
                          <option value='5'>5</option>
                         
                        </select>
                        
                      </div>
                      </div>

                    </div>

                    <div class="col-12">

                      <div class="form-input ">
                        <textarea required  name='description' rows="8"></textarea>
                        <label class="lh-1 text-16 text-light-1">Description</label>
                      </div>

                    </div>

                    <div class="col-12" style="display:flex;justify-content:center;">
                      <h4 class="text-18 fw-500 mb-20">Gallery</h4>
                      <br>
                        <input type="file" name="image1" id="image1" >
                        <input type="file"  name="image2" id="image2" >
                        <input type="file"  name="image3" id="image3" >
                        <input type="file"  name="image4" id="image4" >
                        
                    </div>
                  </div>
                  

                  <div class="contactForm row y-gap-30">
                    
                    
                    <div class="col-12">

                      <div class="form-input ">
                        <input type="text" name='destination_place' required>
                        <label class="lh-1 text-16 text-light-1">Destination</label>
                      </div>

                    </div>
                    
                    <div class="col-6">

                      <div class="form-input ">
                        <input type="text"  name='price' minlength="3" maxlength="7"  required>
                        <label class="lh-1 text-16 text-light-1">₹ Price</label>
                      </div>

                    </div>
                    <div class="col-6">

                      <div class="form-input ">
                        <label class="lh-1 text-16 ">Days</label>
                      <div class="form-input ">
                        
                        <select name="days" required>
                          <option value='1'>1</option>
                          <option value='2'>2</option>
                          <option value='3'>3</option>
                          <option value='4'>4</option>
                          <option value='5'>5</option>
                          <option value='6'>6</option>
                          <option value='7'>7</option>
                        </select>
                        
                      </div>
                      </div>

                    </div>

                    <div class="col-lg-6">
                      <label class="lh-1 text-16 ">Currency Used</label>
                      <div class="form-input ">
                        
                        <select name="currency" required>
                          <option value='Eure'>Eure</option>
                          <option value='Doller'>Doller</option>
                          <option value='Rupee'>Rupee</option>
                        </select>
                        
                      </div>

                    </div>
                    <div class="col-lg-6">
                      <label class="lh-1 text-16 ">Language</label>
                      <div class="form-input ">
                        
                        <select  name="language" required>
                          <option value='English'>English</option>
                          <option value='Doller'>Doller</option>
                          <option value='Rupee'>Rupee</option>
                        </select>
                        
                      </div>

                    </div>
                    <div class="col-12">

                      <div class="form-input ">
                        <input type="text" name='sub_title' required>
                        <label class="lh-1 text-16 text-light-1">Sub Title</label>
                      </div>

                    </div>

                    <div class="col-12">

                      <div class="form-input ">
                        <textarea required  name='sub_description' rows="4"></textarea>
                        <label class="lh-1 text-16 text-light-1">Sub Description</label>
                      </div>

                    </div>

                    <div class="col-12">
                      <label class="lh-1 text-16 ">Sub Image</label>
                      <div class="form-input ">
                        <input type="file" class='form-control' name='sub_image' required>
                       
                      </div>

                    </div>

                   
                  </div>
                  
                </div>




                  <div class="col-12 mt-5">
                    <button type='submit' class="button -md -dark-1 bg-accent-1 text-white">
                      Save Changes
                      <i class="icon-arrow-top-right text-16 ml-10"></i>
                    </button>
                  </div>

                    
                  </div>
                </div>

              
            </div>
          
          </div>
        </form>
        </div>
      
      </div>
    </div>

 

  </div>
</div>
<div class="text-center pt-30 pb-30">
  © Copyright Tourm 2023
</div>

 <!-- JavaScript -->

 <script>
  document.getElementById('uploadArea').addEventListener('click', function () {
    document.getElementById('imageUpload').click();
});

let uploadedImagesCount = 0;

function previewImages(event) {
    const files = event.target.files;
    const imagePreviewArea = document.getElementById('imagePreviewArea');
    const hiddenInputs = [
        document.getElementById('image1'),
        document.getElementById('image2'),
        document.getElementById('image3'),
        document.getElementById('image4')
    ];

    // Reset the preview area and hidden input values if new files are selected
    imagePreviewArea.innerHTML = '';
    uploadedImagesCount = 0;
    hiddenInputs.forEach(input => input.value = ''); // Clear all hidden inputs

    if (files.length > 0) {
        for (let i = 0; i < files.length; i++) {
            if (uploadedImagesCount < 4) { // Ensure a maximum of 4 images
                const file = files[i];
                const reader = new FileReader();

                reader.onload = function (e) {
                    const imagePreviewDiv = document.createElement('div');
                    imagePreviewDiv.classList.add('relative');
                    imagePreviewDiv.style.width = '200px';
                    imagePreviewDiv.style.height = '200px';
                    imagePreviewDiv.style.position = 'relative';

                    const imgElement = document.createElement('img');
                    imgElement.src = e.target.result;
                    imgElement.alt = 'image';
                    imgElement.classList.add('size-200', 'rounded-12', 'object-cover');
                    imgElement.style.width = '100%';
                    imgElement.style.height = '100%';

                    const deleteButton = document.createElement('button');
                    deleteButton.classList.add('absoluteIcon1', 'button', '-dark-1');
                    deleteButton.innerHTML = '<i class="icon-delete text-18"></i>';

                    // Add event listener to delete the image
                    deleteButton.onclick = function () {
                        imagePreviewDiv.remove();
                        hiddenInputs[uploadedImagesCount - 1].value = ''; // Clear the corresponding hidden input
                        uploadedImagesCount--; // Decrement the uploaded count
                    };

                    imagePreviewDiv.appendChild(imgElement);
                    imagePreviewDiv.appendChild(deleteButton);

                    imagePreviewArea.appendChild(imagePreviewDiv);

                    // Update the corresponding hidden input value
                    hiddenInputs[uploadedImagesCount].value = e.target.result; // Base64 value of the image
                    uploadedImagesCount++; // Increment the uploaded count
                };

                reader.readAsDataURL(file);
            } else {
                alert('You can upload a maximum of 4 images.');
                break;
            }
        }
    }
}
  // Update the hidden inputs with the uploaded images
  function updateHiddenInputs() {
      const hiddenInputs = [document.getElementById('image1'), document.getElementById('image2'), document.getElementById('image3'), document.getElementById('image4')];
      const images = document.querySelectorAll('#imagePreviewArea img');

      for (let i = 0; i < 4; i++) {
          if (i < images.length) {
              hiddenInputs[i].value = images[i].src; // Set the hidden input value to the image data

            } else {
              hiddenInputs[i].value = ''; // Clear the hidden input if no image
          }
      }
  }

  // Prevent form submission if less than 1 image is uploaded
  document.getElementById('imageForm').addEventListener('submit', function(e) {
      if (uploadedImagesCount < 1) {
          alert('Please upload at least one image.');
          e.preventDefault(); // Prevent form submission
      }
  });
</script>




 <script src="static/dashboard/js/chart.min.js" integrity="sha512-QSkVNOCYLtj73J4hbmVoOV6KVZuMluZlioC+trLpewV8qMjsWqlIQvkn1KGX2StWvPMdWGBqim1xlC8krl1EKQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
 <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAAz77U5XQuEME6TpftaMdX0bBelQxXRlM"></script>
 <script src="static/dashboard/js/index.min.js"></script>
 <script src="static/dashboard/js/vendors.js"></script>
 <script src="static/dashboard/js/main.js"></script>

 
{% endblock content %}